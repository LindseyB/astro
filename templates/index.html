{% extends "base.html" %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/location-map.js') }}"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
{% endblock %}

{% block content %}
<h1>🌟 <i>Astro Horoscope</i></h1>
<p style="text-align: center; color: #666;">Enter your birth information to generate your natal chart to get a super chill super accurate horoscope</p>

<form action="/chart" method="POST">
    <div class="form-group">
        <label for="birth_date">Birth Date:</label>
        <input type="date" id="birth_date" name="birth_date" required 
               value="1990-01-01">
    </div>
    
    <div class="form-group">
        <label for="birth_time">Birth Time (24-hour format):</label>
        <input type="time" id="birth_time" name="birth_time" required 
               value="09:00">
    </div>
    
    <div class="form-group">
        <label for="timezone_offset">Timezone Offset (e.g., -04:00 for EDT, -05:00 for EST):</label>
        <input type="text" id="timezone_offset" name="timezone_offset" required 
               placeholder="-04:00" value="-04:00" pattern="[+-]\d{2}:\d{2}">
        <small style="color: #666;">Format: +/-HH:MM (include daylight savings adjustment)</small>
    </div>
    
    <!-- Interactive Location Selector -->
    <div class="form-group">
        <label>📍 Select Birth Location:</label>
        <div class="location-selector">
            <div class="location-search">
                <input type="text" id="locationSearch" placeholder="Search for a city or address..." 
                       style="width: 70%; padding: 8px; margin-right: 10px; border: 1px solid #ddd; border-radius: 4px;">
                <button type="button" onclick="searchLocation()" 
                        style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Search
                </button>
            </div>
            <div id="locationMap" style="height: 300px; width: 100%; border-radius: 8px; margin: 10px 0; border: 1px solid #ddd;"></div>
            <div id="locationDisplay" style="padding: 10px; background: #f7fafc; border-radius: 4px; font-size: 14px; color: #666;">
                Click on the map or search for a location to set your birth place
            </div>
        </div>
    </div>
    
    <div class="form-group">
        <label for="latitude">Latitude (auto-filled from map):</label>
        <input type="text" id="latitude" name="latitude" required 
               placeholder="40n42" value="40n42" readonly>
        <small style="color: #666;">Format: DDnMM for North, DDsM for South</small>
    </div>
    
    <div class="form-group">
        <label for="longitude">Longitude (auto-filled from map):</label>
        <input type="text" id="longitude" name="longitude" required 
               placeholder="74w00" value="74w00" readonly>
        <small style="color: #666;">Format: DDwMM for West, DDeMM for East</small>
    </div>
    
    <div class="button-group">
        <button type="submit" formaction="/chart">Get Horoscope 🔮</button>
        <button type="submit" formaction="/full-chart">View Full Chart 📊</button>
    </div>
</form>

<div style="margin-top: 30px; padding: 20px; background: #f7fafc; border-radius: 10px;">
    <h3>📍 Location Help</h3>
    <p><strong>🗺️ Using the Interactive Map:</strong></p>
    <ul>
        <li>Click anywhere on the map to set your birth location</li>
        <li>Search for your birth city in the search box above the map</li>
        <li>The map will automatically detect your current location (if you allow it)</li>
        <li>Coordinates will be automatically converted to astrology format</li>
    </ul>
    <p><small>💡 The map makes it easy to find your exact birth location - just click or search!</small></p>
</div>
{% endblock %}
