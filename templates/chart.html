{% extends "base.html" %}

{% block content %}
<h1>🌟 Your Astrological Chart</h1>

<div class="chart-section">
    <h2>Main Signs</h2>
    <div class="main-signs">
        <div class="sign-card">
            <h3>☀️ Sun Sign</h3>
            <p><strong>{{ chart_data.sun }}</strong></p>
            <small>Your core identity</small>
        </div>
        <div class="sign-card">
            <h3>🌙 Moon Sign</h3>
            <p><strong>{{ chart_data.moon }}</strong></p>
            <small>Your emotional nature</small>
        </div>
        <div class="sign-card">
            <h3>⬆️ Ascendant</h3>
            <p><strong>{{ chart_data.ascendant }}</strong></p>
            <small>Your outer personality</small>
        </div>
    </div>
</div>

<div class="chart-section">
    <h2>🏠 Houses and Planets</h2>
    {% for house_num in range(1, 13) %}
        {% set house_data = chart_data.planets_in_houses[house_num] %}
        <div class="house-item">
            <div class="house-title">{{ chart_data.house_names[house_num] }}</div>
            <div style="margin: 8px 0;"><strong>Sign:</strong> {{ house_data.house_obj.sign }}</div>
            
            {% if house_data.planets %}
                <div><strong>Planets:</strong></div>
                <div class="planet-list">
                    {% for planet in house_data.planets %}
                        <div class="planet-item">• {{ planet.name }}: {{ planet.sign }}</div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="color: #666; font-style: italic;">No planets in this house</div>
            {% endif %}
        </div>
    {% endfor %}
</div>

<div class="chart-section">
    <h2>📡 Current Planetary Positions</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
        {% for planet_name, planet_data in chart_data.current_planets.items() %}
            <div class="planet-status {{ 'planet-retrograde' if planet_data.retrograde else 'planet-direct' }}">
                <h4>{{ planet_name }}</h4>
                <div><strong>{{ planet_data.sign }}</strong> {{ "%.2f"|format(planet_data.degree) }}°</div>
                {% if planet_data.retrograde %}
                    <div class="retrograde-indicator">⚠️ Retrograde</div>
                {% else %}
                    <div class="direct-indicator">✅ Direct</div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
    
    {% set retrograde_planets = chart_data.current_planets.items() | selectattr('1.retrograde') | list %}
    {% if retrograde_planets %}
        <div class="retrograde-summary">
            <h4>⚠️ Currently Retrograde Planets:</h4>
            {% for planet_name, planet_data in retrograde_planets %}
                <span class="retrograde-tag">{{ planet_name }}</span>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-retrograde">
            <h4>✅ No planets are currently retrograde!</h4>
        </div>
    {% endif %}
</div>

<a href="/" class="back-link">← Calculate Another Chart</a>
{% endblock %}
