{% extends "base.html" %}

{% block title %}Your Cosmic Taco Bell Order - Astro Horoscope{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/copy-analysis.js') }}"></script>
{% if streaming %}
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="{{ url_for('static', filename='js/stream-analysis.js') }}"></script>
<script>
    // Pass chart data for streaming analysis
    window.chartDataForStreaming = {
        pageType: 'live-mas',
        birthDate: "{{ form_data.birth_date }}",
        birthTime: "{{ form_data.birth_time }}",
        timezoneOffset: "{{ form_data.timezone_offset }}",
        latitude: "{{ form_data.latitude }}",
        longitude: "{{ form_data.longitude }}",
        musicGenre: "{{ form_data.other_genre if form_data.music_genre == 'other' and form_data.other_genre else form_data.music_genre }}"
    };
</script>
{% endif %}
{% endblock %}

{% block og_title %}{{ chart_data.sun }} â˜‰ {{ chart_data.moon }} â˜½ {{ chart_data.ascendant }} â¬† - Cosmic Taco Bell Order{% endblock %}
{% block og_description %}Personalized Taco Bell order based on astrological chart for {{ chart_data.sun }} sun, {{ chart_data.moon }} moon, and {{ chart_data.ascendant }} rising. ğŸŒ®ğŸ””âœ¨{% endblock %}

{% block twitter_title %}My Cosmic Taco Bell Order: {{ chart_data.sun }} â˜‰ {{ chart_data.moon }} â˜½ {{ chart_data.ascendant }} â¬†{% endblock %}
{% block twitter_description %}Check out my personalized Taco Bell order based on my astrological chart! ğŸŒ®ğŸ””âœ¨{% endblock %}

{% block meta_description %}Personalized Taco Bell order based on astrological chart for {{ chart_data.sun }} sun sign, {{ chart_data.moon }} moon sign, and {{ chart_data.ascendant }} rising sign.{% endblock %}

{% block content %}
{% if streaming %}
<script>document.body.dataset.streaming = 'true';</script>
{% endif %}
<!-- Sparkle Animation Container -->
<div class="sparkle-container" id="sparkleContainer"></div>

<h1>ğŸ”” <i>Your Cosmic Taco Bell Order</i></h1>

<!-- Taco Bell Order Analysis Section -->
<div class="analysis-section" 
     data-sun="{{ chart_data.sun }}" 
     data-moon="{{ chart_data.moon }}" 
     data-ascendant="{{ chart_data.ascendant }}">
    <h2>ğŸŒ® <i>Your Personalized Taco Bell Order</i></h2>
    <div class="analysis-content" id="analysisContent">
        {% if streaming %}
        <!-- Content will be loaded via streaming JavaScript -->
        {% else %}
        {{ chart_data.taco_bell_order | markdown | safe }}
        {% endif %}
    </div>
    <button id="copyAnalysisBtn" class="copy-btn copy-btn-small copy-btn-float" onclick="copyAnalysis()" title="Copy your Taco Bell order">
        ğŸ“‹
    </button>
</div>

<!-- Main Signs -->
<div class="chart-section">
    <h2><i>Your Cosmic Trinity</i></h2>
    <div class="main-signs">
        <div class="sign-card">
            <h3>â˜€ï¸ Sun Sign</h3>
            <p><strong>{{ chart_data.sun }}</strong></p>
            <small>Your core identity</small>
        </div>
        <div class="sign-card">
            <h3>ğŸŒ™ Moon Sign</h3>
            <p><strong>{{ chart_data.moon }}</strong></p>
            <small>Your emotional nature</small>
        </div>
        <div class="sign-card">
            <h3>â¬†ï¸ Rising Sign</h3>
            <p><strong>{{ chart_data.ascendant }}</strong></p>
            <small>Your outer personality</small>
        </div>
    </div>
</div>

<!-- Mercury Retrograde Status -->
{% if chart_data.mercury_retrograde %}
<div class="mercury-warning">
    âš ï¸ <strong>Mercury is in retrograde!</strong> Double-check your Taco Bell order before placing it!
</div>
{% endif %}
<div class="navigation-links">
    <a href="/" class="back-link">â† Get another horoscope</a>
</div>
{% endblock %}


